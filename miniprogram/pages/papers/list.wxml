<!--pages/papers/list.wxml-->
<wxs module="dateUtil">
  var formatDate = function(date) {
    if (!date) return ''
    if (typeof date === 'string' && date.length >= 10) {
      return date.substring(0, 10)
    }
    return date
  }
  module.exports = {
    formatDate: formatDate
  }
</wxs>

<view class="container">
  <!-- 论文列表 -->
  <view class="list-container">
    <view 
      wx:for="{{papers}}" 
      wx:key="id"
      class="list-item card"
      bindtap="goToDetail"
      data-id="{{item.id}}"
    >
      <view class="list-item-title">{{item.title}}</view>
      <view class="list-item-desc">
        <text>作者：{{item.authors}}</text>
      </view>
      <view class="list-item-desc">
        <text>期刊：{{item.journal}}</text>
        <text class="ml-10" wx:if="{{item.jcr_zone}}">
          <text class="tag tag-warning">JCR {{item.jcr_zone}}</text>
        </text>
      </view>
      <view class="list-item-desc">
        <text class="text-muted">发表日期：{{dateUtil.formatDate(item.publication_date)}}</text>
      </view>
    </view>

    <!-- 空状态 -->
    <view wx:if="{{papers.length === 0 && !loading}}" class="empty">
      <text class="empty-text">暂无论文数据</text>
    </view>

    <!-- 加载中 -->
    <view wx:if="{{loading}}" class="loading">
      <text>加载中...</text>
    </view>

    <!-- 没有更多 -->
    <view wx:if="{{finished && papers.length > 0}}" class="loading">
      <text>没有更多了</text>
    </view>
  </view>
</view>