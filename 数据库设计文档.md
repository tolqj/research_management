# ç§‘ç ”ç®¡ç†ç³»ç»Ÿæ•°æ®åº“è®¾è®¡æ–‡æ¡£

## ğŸ“Š æ•°æ®åº“æ¦‚è¿°

- **æ•°æ®åº“åç§°**: research_management_system
- **å­—ç¬¦é›†**: utf8mb4
- **æ’åºè§„åˆ™**: utf8mb4_unicode_ci
- **æ•°æ®åº“å¼•æ“**: InnoDB

---

## ğŸ“‹ æ•°æ®è¡¨æ¸…å•

| è¡¨å | è¯´æ˜ | è®°å½•æ•°ï¼ˆç¤ºä¾‹ï¼‰ |
|------|------|---------------|
| users | ç”¨æˆ·è¡¨ | 3 |
| projects | ç§‘ç ”é¡¹ç›®è¡¨ | 2 |
| papers | è®ºæ–‡è¡¨ | 2 |
| funds | ç»è´¹è¡¨ | 2 |
| achievements | æˆæœè¡¨ | 2 |
| operation_logs | æ“ä½œæ—¥å¿—è¡¨ | - |

---

## ğŸ—‚ï¸ è¡¨ç»“æ„è¯¦ç»†è®¾è®¡

### 1. ç”¨æˆ·è¡¨ (users)

**è¯´æ˜**: å­˜å‚¨ç³»ç»Ÿç”¨æˆ·ä¿¡æ¯ï¼Œæ”¯æŒå¤šè§’è‰²ç®¡ç†

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|----------|--------|------|
| id | INT | - | NO | AUTO_INCREMENT | ä¸»é”® |
| username | VARCHAR | 50 | NO | - | ç”¨æˆ·åï¼ˆå”¯ä¸€ï¼‰ |
| password_hash | VARCHAR | 255 | NO | - | å¯†ç å“ˆå¸Œå€¼ |
| name | VARCHAR | 50 | NO | - | å§“å |
| role | ENUM | - | NO | 'æ™®é€šæ•™å¸ˆ' | è§’è‰²ï¼ˆç®¡ç†å‘˜/ç§‘ç ”ç§˜ä¹¦/æ™®é€šæ•™å¸ˆï¼‰ |
| title | VARCHAR | 50 | YES | NULL | èŒç§° |
| college | VARCHAR | 100 | YES | NULL | å­¦é™¢ |
| email | VARCHAR | 100 | YES | NULL | é‚®ç®±ï¼ˆå”¯ä¸€ï¼‰ |
| phone | VARCHAR | 20 | YES | NULL | ç”µè¯ |
| research_field | VARCHAR | 200 | YES | NULL | ç ”ç©¶æ–¹å‘ |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¶é—´ |

**ç´¢å¼•:**
- PRIMARY KEY: id
- UNIQUE: username
- UNIQUE: email
- INDEX: username

**è§’è‰²æšä¸¾å€¼:**
- ç®¡ç†å‘˜
- ç§‘ç ”ç§˜ä¹¦
- æ™®é€šæ•™å¸ˆ

---

### 2. é¡¹ç›®è¡¨ (projects)

**è¯´æ˜**: å­˜å‚¨ç§‘ç ”é¡¹ç›®çš„å…¨éƒ¨ä¿¡æ¯

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|----------|--------|------|
| id | INT | - | NO | AUTO_INCREMENT | ä¸»é”® |
| project_name | VARCHAR | 200 | NO | - | é¡¹ç›®åç§° |
| pi_id | INT | - | NO | - | è´Ÿè´£äººIDï¼ˆå¤–é”®â†’users.idï¼‰ |
| pi_name | VARCHAR | 50 | NO | - | è´Ÿè´£äººå§“å |
| members | TEXT | - | YES | NULL | é¡¹ç›®æˆå‘˜ï¼ˆJSONæ ¼å¼ï¼‰ |
| project_type | VARCHAR | 100 | YES | NULL | é¡¹ç›®ç±»å‹ |
| source | VARCHAR | 100 | YES | NULL | é¡¹ç›®æ¥æº |
| budget_total | FLOAT | - | YES | 0.0 | æ€»é¢„ç®—ï¼ˆå…ƒï¼‰ |
| start_date | DATE | - | YES | NULL | å¼€å§‹æ—¥æœŸ |
| end_date | DATE | - | YES | NULL | ç»“æŸæ—¥æœŸ |
| status | ENUM | - | NO | 'è‰ç¨¿' | é¡¹ç›®çŠ¶æ€ |
| description | TEXT | - | YES | NULL | é¡¹ç›®æè¿° |
| objectives | TEXT | - | YES | NULL | ç ”ç©¶ç›®æ ‡ |
| attachments | TEXT | - | YES | NULL | é™„ä»¶ï¼ˆJSONæ ¼å¼ï¼‰ |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¶é—´ |

**ç´¢å¼•:**
- PRIMARY KEY: id
- FOREIGN KEY: pi_id REFERENCES users(id)

**çŠ¶æ€æšä¸¾å€¼:**
- è‰ç¨¿
- å·²ç”³æŠ¥
- å·²æ‰¹å‡†
- æ‰§è¡Œä¸­
- ä¸­æœŸæ£€æŸ¥
- å·²ç»“é¢˜
- å·²æ‹’ç»

---

### 3. è®ºæ–‡è¡¨ (papers)

**è¯´æ˜**: å­˜å‚¨è®ºæ–‡å‘è¡¨ä¿¡æ¯

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|----------|--------|------|
| id | INT | - | NO | AUTO_INCREMENT | ä¸»é”® |
| title | VARCHAR | 300 | NO | - | è®ºæ–‡æ ‡é¢˜ |
| authors | VARCHAR | 500 | NO | - | ä½œè€…åˆ—è¡¨ |
| journal | VARCHAR | 200 | YES | NULL | æœŸåˆŠåç§° |
| publication_date | DATE | - | YES | NULL | å‘è¡¨æ—¥æœŸ |
| doi | VARCHAR | 100 | YES | NULL | DOI |
| jcr_zone | VARCHAR | 10 | YES | NULL | JCRåˆ†åŒºï¼ˆQ1/Q2/Q3/Q4ï¼‰ |
| cas_zone | VARCHAR | 10 | YES | NULL | ä¸­ç§‘é™¢åˆ†åŒºï¼ˆä¸€åŒº/äºŒåŒº/ä¸‰åŒº/å››åŒºï¼‰ |
| impact_factor | FLOAT | - | YES | NULL | å½±å“å› å­ |
| project_id | INT | - | YES | NULL | å…³è”é¡¹ç›®IDï¼ˆå¤–é”®â†’projects.idï¼‰ |
| creator_id | INT | - | NO | - | å½•å…¥äººIDï¼ˆå¤–é”®â†’users.idï¼‰ |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¶é—´ |

**ç´¢å¼•:**
- PRIMARY KEY: id
- FOREIGN KEY: project_id REFERENCES projects(id)
- FOREIGN KEY: creator_id REFERENCES users(id)

---

### 4. ç»è´¹è¡¨ (funds)

**è¯´æ˜**: è®°å½•é¡¹ç›®ç»è´¹æ”¯å‡ºæ˜ç»†

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|----------|--------|------|
| id | INT | - | NO | AUTO_INCREMENT | ä¸»é”® |
| project_id | INT | - | NO | - | é¡¹ç›®IDï¼ˆå¤–é”®â†’projects.idï¼‰ |
| expense_type | VARCHAR | 100 | NO | - | æ”¯å‡ºç±»å‹ |
| amount | FLOAT | - | NO | - | é‡‘é¢ï¼ˆå…ƒï¼‰ |
| expense_date | DATE | - | NO | - | æ”¯å‡ºæ—¥æœŸ |
| handler | VARCHAR | 50 | YES | NULL | ç»åŠäºº |
| notes | TEXT | - | YES | NULL | å¤‡æ³¨ |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | åˆ›å»ºæ—¶é—´ |

**ç´¢å¼•:**
- PRIMARY KEY: id
- FOREIGN KEY: project_id REFERENCES projects(id) ON DELETE CASCADE

**å¸¸è§æ”¯å‡ºç±»å‹:**
- è®¾å¤‡è´¹
- å·®æ—…è´¹
- ä¼šè®®è´¹
- ææ–™è´¹
- æµ‹è¯•åŒ–éªŒåŠ å·¥è´¹
- åŠ³åŠ¡è´¹
- ä¸“å®¶å’¨è¯¢è´¹
- å…¶ä»–

---

### 5. æˆæœè¡¨ (achievements)

**è¯´æ˜**: å­˜å‚¨å„ç±»ç§‘ç ”æˆæœ

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|----------|--------|------|
| id | INT | - | NO | AUTO_INCREMENT | ä¸»é”® |
| achievement_type | ENUM | - | NO | - | æˆæœç±»å‹ |
| title | VARCHAR | 200 | NO | - | æˆæœåç§° |
| owner | VARCHAR | 100 | NO | - | æˆæœæ‰€æœ‰äºº |
| members | VARCHAR | 500 | YES | NULL | å‚ä¸äººå‘˜ |
| completion_date | DATE | - | YES | NULL | å®Œæˆæ—¥æœŸ |
| certificate_no | VARCHAR | 100 | YES | NULL | è¯ä¹¦ç¼–å· |
| description | TEXT | - | YES | NULL | æˆæœæè¿° |
| attachments | TEXT | - | YES | NULL | é™„ä»¶ï¼ˆJSONæ ¼å¼ï¼‰ |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | åˆ›å»ºæ—¶é—´ |
| updated_at | DATETIME | - | NO | CURRENT_TIMESTAMP | æ›´æ–°æ—¶é—´ |

**ç´¢å¼•:**
- PRIMARY KEY: id

**æˆæœç±»å‹æšä¸¾å€¼:**
- ä¸“åˆ©
- å¥–é¡¹
- è‘—ä½œ
- è½¯ä»¶è‘—ä½œæƒ

---

### 6. æ“ä½œæ—¥å¿—è¡¨ (operation_logs)

**è¯´æ˜**: è®°å½•ç³»ç»Ÿæ“ä½œæ—¥å¿—

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|------|----------|--------|------|
| id | INT | - | NO | AUTO_INCREMENT | ä¸»é”® |
| user_id | INT | - | YES | NULL | ç”¨æˆ·IDï¼ˆå¤–é”®â†’users.idï¼‰ |
| username | VARCHAR | 50 | YES | NULL | ç”¨æˆ·å |
| operation | VARCHAR | 100 | YES | NULL | æ“ä½œç±»å‹ |
| module | VARCHAR | 50 | YES | NULL | æ¨¡å—åç§° |
| details | TEXT | - | YES | NULL | æ“ä½œè¯¦æƒ… |
| ip_address | VARCHAR | 50 | YES | NULL | IPåœ°å€ |
| created_at | DATETIME | - | NO | CURRENT_TIMESTAMP | æ“ä½œæ—¶é—´ |

**ç´¢å¼•:**
- PRIMARY KEY: id
- FOREIGN KEY: user_id REFERENCES users(id)
- INDEX: created_at

---

## ğŸ”— ERå›¾ï¼ˆå®ä½“å…³ç³»å›¾ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  users  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 1:N (pi_id)
     â”‚
â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  projects   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚  funds   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  1:N    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ 1:N (project_id)
     â”‚
â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   papers    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ achievements â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
(ç‹¬ç«‹è¡¨ï¼Œæ— å¤–é”®)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ operation_logs  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
(æ—¥å¿—è¡¨ï¼Œå…³è”users)
```

---

## ğŸ“ˆ æ•°æ®ç»Ÿè®¡è§†å›¾ï¼ˆå¯é€‰ï¼‰

å¯æ ¹æ®éœ€è¦åˆ›å»ºè§†å›¾ç®€åŒ–æŸ¥è¯¢ï¼š

### é¡¹ç›®ç»è´¹æ±‡æ€»è§†å›¾
```sql
CREATE VIEW v_project_fund_summary AS
SELECT 
    p.id AS project_id,
    p.project_name,
    p.budget_total,
    COALESCE(SUM(f.amount), 0) AS total_expense,
    p.budget_total - COALESCE(SUM(f.amount), 0) AS remaining
FROM projects p
LEFT JOIN funds f ON p.id = f.project_id
GROUP BY p.id;
```

### ç”¨æˆ·è®ºæ–‡ç»Ÿè®¡è§†å›¾
```sql
CREATE VIEW v_user_paper_stats AS
SELECT 
    u.id AS user_id,
    u.name,
    COUNT(pa.id) AS paper_count,
    COUNT(CASE WHEN pa.jcr_zone = 'Q1' THEN 1 END) AS q1_count
FROM users u
LEFT JOIN papers pa ON u.id = pa.creator_id
GROUP BY u.id;
```

---

## ğŸ”§ æ•°æ®åº“ç»´æŠ¤

### å®šæœŸä¼˜åŒ–
```sql
-- åˆ†æè¡¨
ANALYZE TABLE users, projects, papers, funds, achievements;

-- ä¼˜åŒ–è¡¨
OPTIMIZE TABLE users, projects, papers, funds, achievements;
```

### å¤‡ä»½å‘½ä»¤
```bash
# å®Œæ•´å¤‡ä»½
mysqldump -u root -p research_management_system > rms_backup_20241202.sql

# ä»…ç»“æ„
mysqldump -u root -p --no-data research_management_system > rms_structure.sql

# ä»…æ•°æ®
mysqldump -u root -p --no-create-info research_management_system > rms_data.sql
```

### æ¢å¤å‘½ä»¤
```bash
mysql -u root -p research_management_system < rms_backup_20241202.sql
```

---

## ğŸ“ è®¾è®¡è¯´æ˜

1. **å¤–é”®çº¦æŸ**: ç¡®ä¿æ•°æ®å®Œæ•´æ€§ï¼Œçº§è”åˆ é™¤é¿å…å­¤ç«‹æ•°æ®
2. **ç´¢å¼•ä¼˜åŒ–**: ä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µæ·»åŠ ç´¢å¼•
3. **JSONå­—æ®µ**: memberså’Œattachmentsä½¿ç”¨JSONå­˜å‚¨çµæ´»æ•°æ®
4. **æ—¶é—´æˆ³**: è‡ªåŠ¨è®°å½•created_atå’Œupdated_at
5. **è½¯åˆ é™¤**: æœªå®ç°ï¼ˆå¦‚éœ€è¦å¯æ·»åŠ deleted_atå­—æ®µï¼‰

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2024-12-02  
**è®¾è®¡äººå‘˜**: ç§‘ç ”ç®¡ç†ç³»ç»Ÿå¼€å‘å›¢é˜Ÿ
